<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Edit Profile</title>

  <link rel="stylesheet" href="public/styles/reset.css" />
  <link rel="stylesheet" href="public/styles/tokens.css" />
  <link rel="stylesheet" href="public/styles/page.css" />

  <style>
    body {
      font-family: Inter, sans-serif;
      padding: 40px;
      background: var(--surface-1, #f5f6ff);
    }

    .card {
      max-width: 600px;
      margin: 0 auto;
      padding: 30px 40px;
      background: white;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.1);
    }

    label {
      display: block;
      margin-top: 20px;
      font-weight: 600;
      color: #333;
    }

    input {
      width: 100%;
      padding: 12px;
      margin-top: 6px;
      border-radius: 10px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }

    button {
      margin-top: 24px;
      width: 100%;
      padding: 12px;
      background: #4f46e5;
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1.1rem;
      cursor: pointer;
    }

    button:hover {
      background: #4338ca;
    }
  </style>

  <script type="module">
    import { loadProfile, saveProfile } from "/src/services/profile-service.js";

    const params = new URLSearchParams(window.location.search);
    const user = params.get("user");

    const usernameInput = document.getElementById("username");
    const nameInput = document.getElementById("name");
    const emailInput = document.getElementById("email");

    async function load() {
      const profile = await loadProfile(user);
      usernameInput.value = profile.username;
      nameInput.value = profile.name;
      emailInput.value = profile.email;
    }

    load();

    document.getElementById("save-btn").addEventListener("click", async () => {
      const updated = {
        name: nameInput.value,
        email: emailInput.value
      };

      await saveProfile(user, updated);
      alert("Profile saved!");
      window.location.href = "/index.html";
    });
  </script>

</head>

<body>
  <div class="card">
    <h2>Edit Profile</h2>

    <label>Username</label>
    <input id="username" disabled />

    <label>Full Name</label>
    <input id="name" placeholder="Your name" />

    <label>Email</label>
    <input id="email" placeholder="you@example.com" />

    <button id="save-btn">Save Changes</button>
  </div>
</body>
</html>
